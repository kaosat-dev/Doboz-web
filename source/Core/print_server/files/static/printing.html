<html>
  <head>
    <title>Doboz experimental web ui</title>
    <!--TODO : remove , only for testing--> <meta http-equiv="Content-Type" content="no-cache">
    
    <!--<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">-->
     <link type="text/css" href="/css/dobozui-theme/jquery-ui-1.8.9.custom.css" rel="Stylesheet" />    
    <link type="text/css" href="/css/ui.notify.css" rel="Stylesheet" />
    
    
    <script language="javascript" type="text/javascript" src="/js/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="/js/jquery-ui-1.8.9.custom.min.js"></script>
    
    <script language="javascript" type="text/javascript" src="./js/dobozui_tools.js"></script>
    <script language="javascript" type="text/javascript" src="./js/dobozui_toolkit.js"></script>
    
   <!---> <script language="javascript" type="text/javascript" src="./js/classes.js"></script>
    <script language="javascript" type="text/javascript" src="./js/jquery.notify.js"></script>-->
    
    
    <script id="shader-fs" type="x-shader/x-fragment">
        #ifdef GL_ES
        precision highp float;
        #endif
        varying vec4 vColor;
        void main(void) {
          gl_FragColor = vColor;
        }
    </script>
    
    <script id="shader-fs-line" type="x-shader/x-fragment">
        #ifdef GL_ES
        precision highp float;
        #endif
        varying vec4 vColor;
        void main(void) {
          gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
        }
    </script>

<script id="shader-vs" type="x-shader/x-vertex">

  attribute vec3 aVertexPosition;
  attribute vec4 aVertexColor;
  
  uniform mat4 uMVMatrix;
  uniform mat4 uPMatrix;
  varying vec4 vColor;
  void main(void) {
    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    vColor = aVertexColor;
  }
  

</script>
    
    
    <script language="javascript" type="text/javascript" src="/js/webgl-trace.js"></script>
    <script language="javascript" type="text/javascript" src="/js/sylvester.js"></script>
    <script language="javascript" type="text/javascript" src="/js/glu.js"></script>
    <script language="javascript" type="text/javascript" src="/js/webgl_test.js"></script>
   
     <script  type="text/javascript">
      //getAvailableFiles();
       var reprapMgr=new ReprapMgr(); 
       var dobozUi=new DobozUi();
       
      
      /*
      
       $(document).bind("Job.progressUpdated", function(e, status){

    subscribers = $.dobozUi;
    alert("bkag")
    subscribers.onJobProgressUpdated(status);

});*/
      
     $(document).ready
     (
      
     function() 
     {
        dobozUi.onDocumentReady();
      

        $("#uploadProgress").hide();
        $("#uploadTarget").hide();
        $("#textcanvas").hide()
        
        $("#scanOptions").hide();
        $("#files").hide();
        
        

       // $("#controls").addClass("ui-corner-all");
        //getPrintStatus();
       
        $("#scanOptions").dialog({ autoOpen: false,width: 340 });
        $("#files").dialog({ autoOpen: false,width: 640 });
           
        $("#container").notify();
        $("#container").notify("create", {
    title: 'Test Notification',
    text: 'This is an example of the default config, and will fade out after five seconds.'
},{
    speed: 500}
)


      
      }
       
      );
      window.onfocus = onFocus;
      window.onblur = onBlur;
      //reprapMgr.getJobStatus();
     
     </script>
    
     <style type="text/css">
     
         .category 
        {
           
            background-color:#999999;
        }
        .subcategory 
        {
           
        }


        .mainSpacer
        {
          width:100%;
          height:10px;
        }
        .fileListElement
        {
          background-color:#999999;
        }
        .fileListElement:hover
        {
          background-color:#C6E746;
        }
        .fileListElement.selected
        {
          background-color:#528CE0;
          
        }
        body
        {
          background-color: black;
          font-size:50%;
        }
        canvas
        {
          background-color: black;
        }

         .truc
         {
           display:inline-block;
           float:left;
           
         }
         
         .sf
         {       
            height:570px;       
         }


         
      

     </style>
   
    
  </head>
  <body >
    <div id"main" class="category">
        <div id="renderCateg" class=" truc  sf"> 
                <div class="inner" >
                  <div id="canvasWrapper">
                  <canvas id="glcanvas" width="512" height="512">
                    Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
                  </canvas>
                  </div>
                  <div id="webglControls">
                  <input type="button" value="Start webGl" onclick="startWebGL()"/>
                  <input type="button" value="Stop webGl" onclick="stopWebGL()"/>
                  </div>
                </div>
       </div>
       <div id="controls" class="category sf">
            
           
            <div  class="mainControls " >
              <small>
            <button  onclick="reprapMgr.startPauseJob()">Start/Pause</button>
            <button  onclick="reprapMgr.stopJob()">Stop</button>
            <button  onclick="reprapMgr.sendManualCommand(G21)">Manual</button>
            <button  onclick="reprapMgr.getJobStatus()">Status</button>
            <button  onclick="reprapMgr.getMachineStatus()"> Machine Status </button>
            </small>
          </div>
          

        <div id="jobProgressBar" style="height: 20px;"></div>

           
       </div>
     </div>
    
<!--
    
   
            <div id="files" class="category">
              Files:
              <div id="addFile"  class="subcategory">
                Add file:
                <form action="/upload" method="post" enctype="multipart/form-data" target="uploadTarget" onsubmit="UploadFile()">
                <input name="datafile" type="file" onclick="resetUploadProgress()"/>
                <input type="submit" value="Send">
                <iframe id="uploadTarget" src="" style="width:0px;height:0px;"></iframe>
                </form>
              </div>
              <div id="uploadProgress" class="subcategory">
                <div id="wrapper2" style="width:100%;height:20px;">
                  <div id="uploadProgressBar" > </div>
                </div>
              </div>
              <div id="lastFiles" class="subcategory" >
                Available
                <div id="fileListContent"></div>
              </div>
                <a href="./uploads/test2.gcode" >Bla </a>
            </div>
    
    
      <div class="mainSpacer"></div>
              <div id="printJob" class="category" >
                <h3>Current job:
                <input  type="checkbox" name="Print"   onclick="changeToPrint()">Print
                <input   type="checkbox" name="Scan"   onclick="changeToScan()">Scan</h3> 
                <div id="jobOptions" class="subcategory">

                     <div id="scanOptions" class="category">
                          <input type="button" value="Start scan" onclick="startScan()"/>
                          <input id="scanWidth" type='text' value="10"/> width
                          <input id="scanHeight" type='text' value="10"/> height
                          <input id="scanResolution" type='text' value="1"/> resolution<br>
                          (All in mm)
                    </div>
                </div>
                <div id="printControl" class="subcategory">
                     <form >
                    <input name="startPrintButton" type="button" value="Start/Pause" onclick="startPausePrint()"/>
                    <input name="stopPrintButton" type="button" value="Stop" onclick="stopPrint()"/>
                    </form>
                </div>
                <div id="printProgress"  class="subcategory">
                    <div id="wrapper" style="width:100%;height:20px;">
                        <div id="printProgressBar"></div>
                    </div>
                </div>
                <div id="lastCommand"  class="subcategory" >
                    <div style="display:block;width: 100%"><h4>Latest commands</h4>
                      <input id="lastCommandField" type='text'  style="width:100%"/>
                    </div>
                </div>
             </div>
   <div class="mainSpacer"></div>
              <div id="manualControl" class="category">
                Manual control
                <div id="manualcontrols" class="subcategory">
                <input id="manualGCodeField" type='text'/> <input type='button' value="Send Command" onclick="sendManualCommand()"/> 
                </div>
              </div>
    <div class="mainSpacer"></div>
    <div id="debugPanel" class="category">
      Debug info
      <div id="debugContent"  class="subcategory">
         
      </div>
    </div>
   -->
    <div id="container">
 
    <!-- 
    Later on, you can choose which template to use by referring to the 
    ID assigned to each template.  You'll also be able to refer
    to each template by index, so in this example, "basic-tempate" is
    index 0 and "advanced-template" is index 1.
    -->
    <div id="basic-template" style:"position:absolute; bottom:0">
        <a class="ui-notify-cross ui-notify-close" href="#">x</a>
        <h1>#{title}</h1>
        <p>#{text}</p>
        <input type="button" value="test"/>
    </div>
 
    <div id="advanced-template">
        <!-- ... you get the idea ... -->
    </div>
 
</div>
   
    <script type="text/javascript">
     
     
   
     var renderer;
     var firstInit=true;

        
        function fileUpload()
        {
          var filename = $("#datafile").val();
          alert(filename);
          $.ajax(
            { 
              url: mainUrl+"/upload",
              type: "POST",       
              enctype: 'multipart/form-data',
              data: {file: filename},
              success: function()
              {
               alert( "Data Uploaded: ");
              }
            });
            
        }
        ////////////////////////
        
</script>
  </body>
</html>  
